<!DOCTYPE html>
<html lang="en">
<head>
    <title> &middot; Chris Krycho</title>
    <meta name="description" content="I was reading a post by Matt Might, a computer science professor at the University of Utah, about Y Combinators, and I was having a hard time tracking with some of it just by reading. The way I normally solve this problem is to write it out—and, optimally, to ..."/>

    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>

<link rel='me' href='https://alpha.app.net/chriskrycho' data-type='follow' data-user-id='@chriskrycho'/>    <meta property="og:url" content="../2016/.html"/>
    <meta property="og:title" content=""/>
    <meta property="og:description" content="I was reading a post by Matt Might, a computer science professor at the University of Utah, about Y Combinators, and I was having a hard time tracking with some of it just by reading. The way I normally solve this problem is to write it out—and, optimally, to ..."/>
        <meta property="og:image" content="..//assets/images/ck.png"/>
<link rel="author" href=""/>
<link rel="me" href=""/><meta name="twitter:card" content="summary"/>
<meta name="twitter:site" content="@chriskrycho"/>
<meta name="twitter:creator" content="@chriskrycho"/>
    <meta name="twitter:title" content=""/>
    <meta name="twitter:description" content="I was reading a post by Matt Might, a computer science professor at the University of Utah, about Y Combinators, and I was having a hard time tracking with some of it just by reading. The way I normally solve this problem is to write it out—and, optimally, to ..."/>
        <meta name="twitter:image" content="../assets/images/ck.png"/>
    <link rel="me" href="http://stackoverflow.com/users/564181/chris-krycho"/>
    <link rel="me" href="http://www.linkedin.com/in/chriskrycho"/>
    <link rel="me" href="https://soundcloud.com/chriskrycho"/>
    <link rel="me" href="https://vimeo.com/chriskrycho"/>
    <link rel="me" href="http://instagram.com/chriskrycho"/>
    <link rel="me" href="https://www.facebook.com/chriskrycho"/>
    <link rel="me" href="https://github.com/chriskrycho"/>
    <link rel="me" href="mailto:chris at chriskrycho dot com"/>
    <link rel="me" href="https://medium.com/@chriskrycho"/>
    <link rel="me" href="https://twitter.com/chriskrycho"/>
    <link rel="me" href="https://bitbucket.org/chriskrycho"/>

    <link rel="openid.delegate" href="http://www.chriskrycho.com/" />
    <link rel="openid.server" href="https://indieauth.com/openid" />

    <link rel="stylesheet" type="text/css" href="/assets/style.css"/>
    <link rel="stylesheet" type="text/css" href="/assets/fonts.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <link href="/favicon.png" type="image/png" rel="icon" />
    <link href="/favicon.ico" type="image/ico" rel="icon" />

    <script type="text/javascript" src="/assets/js/mtiFontTrackingCode.js"></script>

    <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="All posts">
        <link rel="alternate" href="/feeds/art.xml" type="application/rss+xml" title="Posts filed in in 'Art''">
        <link rel="alternate" href="/feeds/blog.xml" type="application/rss+xml" title="Posts filed in in 'Blog''">
        <link rel="alternate" href="/feeds/micro.xml" type="application/rss+xml" title="Posts filed in in 'Micro''">
        <link rel="alternate" href="/feeds/tech.xml" type="application/rss+xml" title="Posts filed in in 'Tech''">
        <link rel="alternate" href="/feeds/theology.xml" type="application/rss+xml" title="Posts filed in in 'Theology''">
</head>
<body>
    <header id="site-header">
        <div class="hgroup">
            <h1 id="site-title">
<a href=".."><img class="logotype" src="/assets/images/ck.png" alt="ck"/>Chris Krycho</a>
</h1>

            <h2 id="site-subtitle">Theology, technology, life & art</h2>
        </div>

        <nav>
            <ul>
                <li class="section-title"><a href="../about.html">About</a></li>
                <li class="section-title art"><a href="../art/">art</a></li>
                <li class="section-title tech"><a href="../tech/">tech</a></li>
                <li class="section-title theology"><a href="../theology/">theology</a></li>
                <li class="section-title divider" role="presentation"></li>
                <li class="section-title"><a href="../series.html">Series</a></li>
            </ul>
        </nav>

    </header>


<article class="javascript software-development tech">

    <header>
<h1></h1>
<h2>Y Combinators</h2>    </header>

    <div class="meta"><span class="date"><a href="../2016/.html"><i class="fa fa-fw fa-link"></i></a>June 18, 2016</span><span class="section">Filed under <a class="section-title" href="../tech/">tech</a></span><span class="hashtag"><a class="hashtags" href="../javascript/">#javascript</a><a class="hashtags" href="../software-development/">#software development</a></span><span><a href="../2016/.txt">Markdown source</a></span></div>

    <div class="content-wrapper">


        <div class="content">

<p><i class=editorial>I was reading <a href="http://matt.might.net/articles/implementation-of-recursive-fixed-point-y-combinator-in-javascript-for-memoization/">a post</a> by <a href="http://matt.might.net">Matt Might</a>, a computer science professor at the University of Utah, about Y Combinators, and I was having a hard time tracking with some of it just by reading. The way I normally solve this problem is to write it out—and, optimally, to write it out in something roughly like <a href="https://wiki.haskell.org/Literate_programming">Literate Haskell</a> or <a href="http://coffeescript.org/#literate">Literate CoffeeScript</a>. That’s exactly what you’ll find below; this is basically <em>commentary</em> on Might’s original post.</p>
<p>A few other prefatory notes:</p>
<ol type="1">
<li>Since this is commentary, I’m not focusing on explaining combinators in general. For a very helpful explanation, though, both of what combinators are and why you’d ever want to use them <a href="http://programmers.stackexchange.com/a/117575">read this</a>.</li>
<li>The Y Combinator itself isn’t all that useful for ordinary programming. It <em>is</em> really useful as a way of thinking about how programming <em>works</em>, and that’s why I was reading about it and trying to figure out what was going on in Might’s original post.</li>
<li>This didn’t actually all make sense to me until I also read Might’s post, <a href="http://matt.might.net/articles/python-church-y-combinator/">“Equational derivations of the Y combinator and Church encodings in Python”</a>. Which is a crazy post. But kind of fun. </i></li>
</ol>
<hr />
<p>Note for background (this was new to me today): <span class="math inline"><em>λ</em><em>v</em>.<em>e</em></span> is the function which maps v to e. In ECMAScript 2015 or later (hereafter just JS):</p>
<pre class="js"><code>const λv_e = v =&gt; e</code></pre>
<p>The Y Combinator is a higher-order functional: it is a function which takes a functional/higher-order function. Quoting from Might:</p>
<blockquote>
<p>The Y combinator takes a functional as input, and it returns the (unique) fixed point of that functional as its output. A functional is a function that takes a function for its input. Therefore, the fixed point of a functional is going to be a function.</p>
</blockquote>
<p>And a “fixed point” is an input to a function equal to the <em>output</em> of the function. (Not all functions have such.) A fixed point is where <span class="math inline"><em>f</em>(<em>x</em>)=<em>x</em></span>. He uses the example <span class="math inline"><em>x</em> = <em>x</em><sup>2</sup> − 1</span>, which has two solutions, two <em>fixed points</em>.</p>
<p>He starts out with the total recursion form of the Y-combinator (crash all the things!) (I’m using letters to denote the version of the combinator; this is Y-naive.)</p>
<pre class="js"><code>const Yn = (F) =&gt; F(Yn(F))  // all the recursing!</code></pre>
<p>This is fine… except for one pesky little detail: it calls itself immediately, and so recurses infinitely. Which is actually kind of a problem.</p>
<p>What if we transformed this a bit: Might notes that we can <em>transform</em> with lambda calculus to expand what we’re doing, so:</p>
<figure>
<span class="math inline"><em>Y</em>(<em>F</em>)=<em>F</em>(<em>λ</em><em>x</em>.(<em>Y</em>(<em>F</em>))(<em>x</em>))</span>
</figure>
<p>(I haven’t done this kind of thing since undergraduate math work I did for physics, but as I was thinking about it, it made sense. I’m used to trying to <em>remove</em> extraneous variables when dealing with software, but in this case we’re using it as a tool for transforming the equation into a form that is <em>equivalent</em> but <em>expressed differently</em>.)</p>
<p>And <span class="math inline"><em>λ</em><em>x</em>.(<em>Y</em>(<em>F</em>))(<em>x</em>)</span> is equivalent to the fixed point. It’s the function which takes <span class="math inline"><em>x</em></span> as an argument and results in <span class="math inline"><em>Y</em>(<em>F</em>)(<em>x</em>)</span>; but <span class="math inline"><em>Y</em>(<em>F</em>)</span> is just another argument, so this looks just like our original <span class="math inline"><em>f</em>(<em>x</em>)=<em>x</em></span>, but with <span class="math inline"><em>Y</em>(<em>F</em>)</span> for <span class="math inline"><em>f</em></span>. In JS, then, we have this (I’m calling this Y-transformed, so <code>Yt</code>).</p>
<p>My implementation, using modern JS; note that it still recurses:</p>
<pre class="js"><code>const Yt = (F) =&gt; F((x) =&gt; Yt(F)(x))</code></pre>
<p>His version:</p>
<pre class="js"><code>function Y(F) { return F(function(x) { return Y(F)(x); }); }</code></pre>
<p>Mine and his are equivalent; here’s his version transformed to modern JS:</p>
<pre class="js"><code>const Y = (F) =&gt; F((x) =&gt; Y(F)(x))</code></pre>
<p>Might then says:</p>
<blockquote>
<p>Using another construct called the U combinator, we can eliminate the recursive call inside the Y combinator, which, with a couple more transformations gets us to:</p>
</blockquote>
<p>I hated it when profs (or books!) did this when I was in college, and it frustrates me here, too. I want to <em>see</em> the transformation. I really wish Might didn’t skip how the U combinator works or what transformations he applies, because then he jumps to this form:</p>
<figure>
<span class="math inline"><em>Y</em> = (<em>λ</em><em>h</em>.<em>λ</em><em>F</em>.<em>F</em>(<em>λ</em><em>x</em>.((<em>h</em>(<em>h</em>))(<em>F</em>))(<em>x</em>)))(<em>λ</em><em>h</em>.<em>λ</em><em>F</em>.<em>F</em>(<em>λ</em><em>x</em>.((<em>h</em>(<em>h</em>))(<em>F</em>))(<em>x</em>)))</span>
</figure>
<p>Writing this out in JS is going to be a real bear. More to the point, I don’t know how he got to it; now I need to go look up the U Combinator it seems.</p>
<p>…which I’ve now done. So:</p>
<ul>
<li>The U Combinator is the case where you apply a function to itself: <span class="math inline"><em>U</em>(<em>f</em>)=<em>f</em>(<em>f</em>)</span>—you can see that in the result there, where the first expression is the same as the argument handed to it (and both are functions). It’s also there in the <span class="math inline"><em>h</em>(<em>h</em>)</span> calls.</li>
<li>The transformations are just transforming from a function-argument for to a lambda form, I think. The kind of thing where you go from <code>function a(b) { return c }</code> to <code>var a = function(b) { return c }</code> in JS. (Better, in <em>modern</em> JS, to <code>const a = (b) =&gt; c</code>.)</li>
</ul>
<p>I’ll return to that in a moment. First, writing up the JS. The innermost term is (repeated) <span class="math inline"><em>λ</em><em>x</em>.((<em>h</em>(<em>h</em>))(<em>F</em>))(<em>x</em>)</span>, so we’ll start by writing this out.</p>
<pre class="js"><code>const λ_inner = (x) =&gt; (h(h)(F))(x)</code></pre>
<p>We need the definition of <span class="math inline"><em>h</em></span> next; this comes from further out, the transformation <span class="math inline"><em>λ</em><em>h</em>.<em>λ</em><em>F</em>.<em>F</em>(<em>λ</em><sub><em>i</em></sub><em>n</em><em>n</em><em>e</em><em>r</em>)</span> (where we’re substituting the <code>λ_inner</code> we just wrote to make this a bit easier to get our heads around).</p>
<p>Remembering that each “.” in the equation represents a mapping, i.e. a JS function call, we have this (writing it with function definitions starting new lines to clarify):</p>
<p>Here’s what I came up with as a fairly direct translation into JS:</p>
<pre class="js"><code>const Y = (
  (h) =&gt;
    (F) =&gt; F((x) =&gt; (h(h)(F))(x))  // substituting λ_inner from above
) (
  (h) =&gt;
    (F) =&gt; F((x) =&gt; (h(h)(F))(x))  // substituting λ_inner from above
)</code></pre>
<p>His (note that things are aligned as they are so that it’s clear which functions match up):</p>
<pre class="js"><code>var Y = function (F) {
 return (function (x) {
  return F(function (y) { return (x(x))(y);});
  })
        (function (x) {
  return F(function (y) { return (x(x))(y);});
  }) ;
} ;</code></pre>
<p>His transformed to modern JS:</p>
<pre class="js"><code>const Y = (F) =&gt; (
  (x) =&gt; F((y) =&gt; x(x)(y))
) (
  (x) =&gt; F((y) =&gt; x(x)(y))
)</code></pre>
<p>His and mine are not <em>quite</em> the same (though I know they’re equivalent because they both work). I really wish he’d explained how he got <em>this</em> substitution as well! More importantly, I wish he’d been consistent in his notation; changing variable names is… frustrating when you’re trying to follow someone’s work.</p>
<p><i class=editorial>When I get stuck on something like <em>this</em>, the way I figure it out is by writing out how the substitutions would work at each step. See below.</i></p>
<p>In any case, now that we have the Y combinator, we can use it with <code>FactGen</code>, a functional which, if you pass it the factorial function, passes back the factorial function. <code>FactGen</code> itself isn’t recursive. But with the Y Combinator, it builds a function which is <em>not</em> recursive; it doesn’t reference itself anywhere. It just needs the right kind of “factory”: a function which returns <em>another</em> funtion which itself <em>is</em> recursive. Here’s a standard recursive factorial implementation (identical to the one Might supplies, though modernized):</p>
<pre class="js"><code>const FactGen =
  (fact) =&gt;
    (n) =&gt; n === 0 ? 1 : n * fact(n - 1)</code></pre>
<p>You call that like this:</p>
<pre class="js"><code>Y(FactGen)(5)  // 120</code></pre>
<p>The <code>Y(FactGen)</code> call gets back a function which then runs on whatever input you hand it (a fairly standard pattern with curried arguments), so you could also right it like this:</p>
<pre class="js"><code>const factorial = Y(FactGen)
factorial(0)  // 120</code></pre>
<p>But I’m still not sure how his and mine are equivalent.</p>
<p>So in his Y combinator, the substitution goes like this:</p>
<pre class="js"><code>const Y = (FactGen) =&gt; (
  (x) =&gt;  //
    FactGen(
      (y) =&gt; x(x)(y)  // This whole function -&gt; `fact`
    )
) (
  (x) =&gt;
    FactGen((y) =&gt; x(x)(y))
)</code></pre>
<script type='text/javascript' src='/ycombinator.js'>
<div id="refs" class="references">

</div>
        </div>
    </div>
</article>


    <footer id="site-footer"><section id="connect">
    <h2>Connect</h2>
    <ul class="icons">
        <li><a href="https://twitter.com/chriskrycho"><i class="fa fa-fw fa-twitter"></i>Twitter</a></li>
        <li><a href="mailto:chris at chriskrycho dot com"><i class="fa fa-fw fa-envelope"></i>Email</a></li>
        <li><a href="https://github.com/chriskrycho"><i class="fa fa-fw fa-github"></i>GitHub</a></li>
        <li><a href="https://medium.com/@chriskrycho"><i class="fa fa-fw fa-medium"></i>Medium</a></li>
        <li><a href="https://soundcloud.com/chriskrycho"><i class="fa fa-fw fa-soundcloud"></i>SoundCloud</a></li>
        <li><a href="http://instagram.com/chriskrycho"><i class="fa fa-fw fa-instagram"></i>Instagram</a></li>
        <li><a href="http://www.linkedin.com/in/chriskrycho"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a></li>
        <li><a href="https://vimeo.com/chriskrycho"><i class="fa fa-fw fa-vimeo"></i>Vimeo</a></li>
        <li><a href="http://stackoverflow.com/users/564181/chris-krycho"><i class="fa fa-fw fa-stack-overflow"></i>Stack Overflow</a></li>
    </ul>
</section>
<section id="subscribe">
    <h2>Subscribe</h2>
    <ul class="icons">
        <li class="section-title">
            <a href="../None"><i class="fa fa-fw fa-rss"></i>Everything</a>
        </li>
        <li class="section-title">
            <a href="../feeds/art.xml"><i class="fa fa-fw fa-rss"></i>art</a>
        </li>
        <li class="section-title">
            <a href="../feeds/blog.xml"><i class="fa fa-fw fa-rss"></i>blog</a>
        </li>
        <li class="section-title">
            <a href="../feeds/micro.xml"><i class="fa fa-fw fa-rss"></i>micro</a>
        </li>
        <li class="section-title">
            <a href="../feeds/tech.xml"><i class="fa fa-fw fa-rss"></i>tech</a>
        </li>
        <li class="section-title">
            <a href="../feeds/theology.xml"><i class="fa fa-fw fa-rss"></i>theology</a>
        </li>
    </ul>
</section>
<section id="recent">
    <h2>Recent</h2>
    <ul>
        <li>Art: <a href="../2016/mornings-like-this.html">Mornings like this</a></li>
        <li>Blog: <a href="../2016/a-brake-on-our-enthusiasm.html">A brake on our enthusiasm</a></li>
        <li>Tech: <a href="../2016/.html"></a></li>
        <li>Theology: <a href="../2016/irreducible-complexity-and-design-discourse.html">Irreducible Complexity and Design Discourse</a></li>
    </ul>
</section></footer>

    <script async src="http://code.bib.ly/bibly.min.js"></script>
    <link href="http://code.bib.ly/bibly.min.css" rel="stylesheet" />
    <script type="text/javascript">
    var MTIProjectId='a34d2e31-99b5-469a-9b81-128fc0bd9745';
    </script>

<link rel="stylesheet" href="/assets/tomorrow.min.css">
<script src="/assets/js/highlight.pack.js"></script>
<script type="text/javascript">
// Get all the <pre><code> elements, and use the <pre> element to set the <code>
// element's class so hljs will use it rather than trying to figure it out.
var preEls = document.getElementsByTagName('pre');
for (var e in preEls) {
    var pre = preEls[e];
    if (pre.firstChild && pre.firstChild.tagName === 'CODE') {
        var code = pre.firstChild;
        code.className = pre.className;
    }
}

// Then run hljs.
hljs.initHighlightingOnLoad();
</script>

<script type="text/javascript" src="/assets/js/lib.js"></script>
</body>
</html>