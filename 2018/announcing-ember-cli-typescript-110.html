<!DOCTYPE html>
<html lang="en">
<head>
    <title>Announcing ember-cli-typescript 1.1.0 &middot; Chris Krycho</title>
    <meta name="description" content="Now with generators, support for addons, and incremental compilation! A lot has changed in the last six months, and we’re ready to kick the ecosystem into high gear!"/>

    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>

<link rel='me' href='https://alpha.app.net/chriskrycho' data-type='follow' data-user-id='@chriskrycho'/>    <meta property="og:url" content="http://www.chriskrycho.com/2018/announcing-ember-cli-typescript-110.html"/>
    <meta property="og:title" content="Announcing ember-cli-typescript 1.1.0"/>
    <meta property="og:description" content="Now with generators, support for addons, and incremental compilation! A lot has changed in the last six months, and we’re ready to kick the ecosystem into high gear!"/>
        <meta property="og:image" content="http://www.chriskrycho.com//assets/images/ck.png"/>
<link rel="author" href=""/>
<link rel="me" href=""/><meta name="twitter:card" content="summary"/>
<meta name="twitter:site" content="@chriskrycho"/>
<meta name="twitter:creator" content="@chriskrycho"/>
    <meta name="twitter:title" content="Announcing ember-cli-typescript 1.1.0"/>
    <meta name="twitter:description" content="Now with generators, support for addons, and incremental compilation! A lot has changed in the last six months, and we’re ready to kick the ecosystem into high gear!"/>
        <meta name="twitter:image" content="http://www.chriskrycho.com/assets/images/ck.png"/>
    <link rel="me" href="https://bitbucket.org/chriskrycho"/>
    <link rel="me" href="mailto:chris at chriskrycho dot com"/>
    <link rel="me" href="https://www.facebook.com/chriskrycho"/>
    <link rel="me" href="https://github.com/chriskrycho"/>
    <link rel="me" href="http://instagram.com/chriskrycho"/>
    <link rel="me" href="http://www.linkedin.com/in/chriskrycho"/>
    <link rel="me" href="https://medium.com/@chriskrycho"/>
    <link rel="me" href="https://soundcloud.com/chriskrycho"/>
    <link rel="me" href="http://stackoverflow.com/users/564181/chris-krycho"/>
    <link rel="me" href="https://twitter.com/chriskrycho"/>
    <link rel="me" href="https://vimeo.com/chriskrycho"/>

    <link rel="openid.delegate" href="http://www.chriskrycho.com/" />
    <link rel="openid.server" href="https://indieauth.com/openid" />

    <link rel="stylesheet" type="text/css" href="/assets/style.css"/>
    <link rel="stylesheet" type="text/css" href="/assets/fonts.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel='stylesheet' href='//cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css'>

    <link href="/favicon.png" type="image/png" rel="icon" />
    <link href="/favicon.ico" type="image/ico" rel="icon" />

    <script type="text/javascript" src="/assets/js/mtiFontTrackingCode.js"></script>


    <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="All posts">
        <link rel="alternate" href="/feeds/Art.xml" type="application/rss+xml" title="Posts filed in in 'Art''">
        <link rel="alternate" href="/feeds/blog.xml" type="application/rss+xml" title="Posts filed in in 'Blog''">
        <link rel="alternate" href="/feeds/Tech.xml" type="application/rss+xml" title="Posts filed in in 'Tech''">
        <link rel="alternate" href="/feeds/Theology.xml" type="application/rss+xml" title="Posts filed in in 'Theology''">
</head>
<body>
    <header id="site-header">
        <div class="hgroup">
            <h1 id="site-title">
<a href="http://www.chriskrycho.com"><img class="logotype" src="/assets/images/ck.png" alt="ck"/>Chris Krycho</a>
</h1>

            <h2 id="site-subtitle">Theology, technology, life & art</h2>
        </div>

        <nav>
            <ul>
                <li class="section-title"><a href="http://www.chriskrycho.com/about.html">About</a></li>
                <li class="section-title art"><a href="http://www.chriskrycho.com/art/">Art</a></li>
                <li class="section-title tech"><a href="http://www.chriskrycho.com/tech/">Tech</a></li>
                <li class="section-title theology"><a href="http://www.chriskrycho.com/theology/">Theology</a></li>
                <li class="section-title divider" role="presentation"></li>
                <li class="section-title"><a href="http://www.chriskrycho.com/series.html">Series</a></li>
                <li class="section-title divider" role="presentation"></li>
                <li class="section-title"><a href="http://www.chriskrycho.com/now.html">Now</a></li>
            </ul>
        </nav>

    </header>


<article class="emberjs typescript javascript typing-your-ember tech">

    <header>
<h1>Announcing ember-cli-typescript 1.1.0</h1>
<h2>Now with generators, support for addons, and incremental compilation!</h2>    </header>

    <div class="meta">
<span class="date"><a href="http://www.chriskrycho.com/2018/announcing-ember-cli-typescript-110.html"><i class="fa fa-fw fa-link"></i></a>February 12, 2018</span><span class="section">Filed under <a class="section-title" href="http://www.chriskrycho.com/tech/">Tech</a></span><span class="hashtag"><a class="hashtags" href="http://www.chriskrycho.com/emberjs/">#emberjs</a><a class="hashtags" href="http://www.chriskrycho.com/javascript/">#javascript</a><a class="hashtags" href="http://www.chriskrycho.com/typescript/">#typescript</a><a class="hashtags" href="http://www.chriskrycho.com/typing-your-ember/">#typing-your-ember</a></span><span><a href="http://www.chriskrycho.com/2018/announcing-ember-cli-typescript-110.txt">Markdown source</a></span>    </div>

    <div class="content-wrapper">


        <div class="content">

<p>I’m delighted to announce the release of <a href="https://github.com/typed-ember/ember-cli-typescript/releases/tag/v1.1.0">ember-cli-typescript 1.1.0</a>. This first minor release since 1.0 includes the following shiny and awesome new features:</p>
<ul>
<li><a href="#generators">Generators</a></li>
<li><a href="#developing-addons">Support for developing addons in TypeScript</a></li>
<li><a href="#incremental-compilation">Incremental compilation (a.k.a. fast rebuilds in <code>ember serve</code> mode)</a></li>
</ul>
<section id="generators" class="level2">
<h2>Generators</h2>
<p>We’ve now added support for generating <em>all</em> standard Ember items as TypeScript files instead of JavaScript files. So now when you run <code>ember generate component user-profile</code> for example, you’ll get <code>user-profile.ts</code>, <code>user-profile-test.ts</code>, and <code>user-profile.hbs</code>. For most files, this is just a nicety—just two files you don’t have to rename!—but in the case of services, controllers, and Ember Data models, adapters, and serializers it will actually make a really big difference in your experience of using TypeScript in your app or addon.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>Those generators are <em>mostly</em> identical with ones in Ember and Ember Data, just with <code>.ts</code> instead of <code>.js</code> for the extension. The only changes we have made are: (a) we’ve tweaked them to use classes where possible, and (b) we have customized the controller, service, and Ember Data model, adapter, and serializer generators so you get the most mileage out of TypeScript for the least effort we can manage today. So when you do <code>ember generate service session</code>, this is what you’ll see:</p>
<pre class="ts"><code>import Service from &quot;@ember/service&quot;;

export default class Session extends Service.extend({
  // anything which *must* be merged on the prototype
}) {
  // normal class definition
}

// DO NOT DELETE: this is how TypeScript knows how to look up your services.
declare module &quot;ember&quot; {
  interface ServiceRegistry {
    session: Session;
  }
}</code></pre>
<p>Courtesy of these generators, you can now write <em>almost</em> exactly what you’d write in vanilla Ember and get full support for autocompletion of properties and methods on the <code>Session</code> service, as well as type-checking for how you use those. Service and controller injections just require you to explicitly name the service or controller being injected:</p>
<pre class="ts"><code>import Component from &quot;@ember/component&quot;;
import { inject as service } from &quot;@ember/service&quot;;

export default class UserProfile extends Component {
  session = service(&quot;session&quot;);
  // note the string ^ naming the service explicitly
}</code></pre>
<p>So, for example, if your <code>session</code> service had a <code>login</code> method on it:</p>
<pre class="ts"><code>import Service from &quot;@ember/service&quot;;
import RSVP from &quot;rsvp&quot;;

export default class Session extends Service {
  login(email: string, password: string): RSVP.Promise&lt;string&gt; {
    // some API call to log in
  }
}

// DO NOT DELETE: this is how TypeScript knows how to look up your services.
declare module &quot;ember&quot; {
  interface ServiceRegistry {
    session: Session;
  }
}</code></pre>
<p>Then anywhere you injected and used it, you’ll get auto-complete suggestions and type checking:</p>
<figure>
<img src="http://cdn.chriskrycho.com/images/ts-autocomplete.png" alt="autocompletion" /><figcaption>autocompletion</figcaption>
</figure>
<figure>
<img src="http://cdn.chriskrycho.com/images/ts-type-checking.png" alt="type-checking" /><figcaption>type-checking</figcaption>
</figure>
<p>(You’ll see the same kinds of things in other editors, from Vim to IntelliJ IDEA. Visual Studio Code is just my current editor of choice.)</p>
</section>
<section id="addon-development" class="level2">
<h2>Addon development</h2>
<p>As <a href="http://www.chriskrycho.com/2017/announcing-ember-cli-typescript-100.html#the-roadmap">promised with the 1.0 release</a>, 1.1 (though arriving much later than I hoped it would) includes support for developing addons with TypeScript.</p>
<p>Strictly speaking, of course, you could <em>always</em> develop addons using TypeScript, but there were two problems with it: (1) dependency management and (2) manual work required to deal with the dependency management problems.</p>
<section id="dependency-management" class="level3">
<h3>1. Dependency management</h3>
<p>In the normal Ember CLI workflow, TypeScript had to be a <code>dependency</code>—not a <code>devDependency</code>—of the addon, because the normal pattern with Ember CLI is to ship the uncompiled files and have the consumer compile them all together at build time.</p>
<p>This makes a certain amount of sense for Babel given the Ember community’s shared reliance on Babel: it’s just assumed to be part of every app build. In that case, it gives consumers control over their compilation target. If an app only needs to target evergreen browsers, it can do that and ship a smaller payload, because an addon won’t have pre-compiled in things like generator support, etc.</p>
<p>In the case of TypeScript, however, this makes a lot less sense: many (probably <em>most</em>) consumers of addons written in TypeScript will still be normal JavaScript consumers. We did not want to burden normal consumers with a TypeScript compile step. We <em>also</em> didn’t want to burden any consumers with the reality that TypeScript is a <em>large</em> install. TypeScript 2.6.2 is 32MB on disk for me. Even with some degree of deduplication by npm or yarn, if addons used a variety of versions of TypeScript for development—as they surely would!—the install cost for consumers would quickly spiral into a nasty spot. And again: that’s bad enough for someone who <em>wants</em> to use TypeScript in their app; it’s far worse for someone who just wants to consume the compiled JavaScript.</p>
</section>
<section id="manual-workarounds" class="level3">
<h3>2. Manual workarounds</h3>
<p>You could work around all of that by building the JavaScript (and TypeScript definitions) yourself. But as part of that, you had to do all the work of making sure both the JavaScript files and the type definitions you generated ended up in the right place for distribution and consumption. That was always possible, but it was also always going to be a lot of work. In practice, as far as I know, <em>no one has done this</em>.</p>
</section>
<section id="solution" class="level3">
<h3>Solution</h3>
<p>We now support TypeScript as a <code>devDependency</code> and also manage the work of generating JavaScript and type definitions for you. All you have to do is install ember-cli-typescript into an addon, and then when you do your build step, we’ll automatically do the work (on prepublish) of generating TypeScript <code>.d.ts</code> files and JavaScript source for you.</p>
<p>Consumers of your addon, therefore, will (a) not know or care that the addon is written in TypeScript if they just want to consume it as normal JavaScript<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> or (b) will get the benefits of your having written the library in TypeScript without paying the penalty of having to have multiple versions of the TypeScript compiler downloaded to their own app.</p>
<p>One important caveat: we do <em>not</em> support TypeScript in an addon’s <code>app</code> directory. However, for most addons, we don’t think this should be a problem. It’s rare for addons to put actual implementation in the <code>app</code> directory; instead it has simply become conventional for the <code>app</code> directory simply to have re-exports for convenient access to the functionality supplied by the addon.</p>
<p>Also note that you can supply type definitions for your addon <em>without</em> developing the addon itself in TypeScript.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> You do <em>not</em> need ember-cli-typescript installed for that. You only need the addon if you actually want to take advantage of the opportunities TypeScript affords for developing your own addon.</p>
</section>
</section>
<section id="incremental-compilation" class="level2">
<h2>Incremental compilation</h2>
<p>Last but not least, we’ve managed—mostly through the hard work of both Dan Freeman (<a href="https://github.com/dfreeman">@dfreeman</a>) and Derek Wickern (<a href="https://github.com/dwickern">@dwickern</a>—to get support for TypeScript’s <code>--watch</code> mode integrated.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> What this means in practice is: <em>way</em> faster iteration as you work.</p>
<p>Previously, every time you triggered <em>any</em> change in your app (even if it didn’t involve any TypeScript files at all), the TypeScript compiler would recompile <em>all</em> the TypeScript files in your application. We didn’t initially have a good way to make TypeScript and Broccoli (and therefore Ember CLI) communicate clearly about what had changed. Now, courtesy of Dan and Derek’s hard work (and my cheerleading, testing, and fixing a few corner pieces along the way), we do! So when you change a <code>.hbs</code> file or a <code>.js</code> file… the TypeScript compiler won’t do anything. And when you change a TypeScript file, the TypeScript compiler will <em>only</em> recompile that file.</p>
<p>On my own app (~35,000 lines of TypeScript across ~700 files), that’s the difference between rebuilds involving TypeScript taking 15–20 seconds and their taking 1–2 seconds. Literally an order of magnitude faster! Over the course of a day of development, that saves a <em>huge</em> amount of time.</p>
<p>The way we did it also solved an incredibly annoying problem we had in the previous pass: <em>any</em> change to your app was triggering <code>tsc</code> to rebuild the entire TypeScript tree of your app, even if you didn’t so much as look at <code>.ts</code> file. This was particularly annoying when combined with the long rebuild times: change a CSS file and wait for your TypeScript files to rebuild? Ugh. But not anymore!</p>
</section>
<section id="credit-and-thanks" class="level2">
<h2>Credit and Thanks</h2>
<p>Massive credit goes to Dan Freeman (<a href="https://github.com/dfreeman">@dfreeman</a>) and Derek Wickern (<a href="https://github.com/dwickern">@dwickern</a>), who did most of the heavy lifting on the internals for this release, and together unlocked both incremental compilation and addon support. Derek also did the lion’s share of the work on writing the types for Ember and Ember Data.</p>
<p>Thanks to Maarten Veenstra (<a href="https://github.com/maerten">@maerten</a>) for the original inspiration (and a spike last summer) for using a type registry, and to Mike North (<a href="https://github.com/maerten">@mike-north</a>) for some discussion and planning around the idea late in 2017. I may have implemented them, but the ideas came from the community!</p>
<p>Thanks to Frank Tan (<a href="https://github.com/tansongyang">@tansongyang</a>) for doing a lot of the work on porting the generators from the Ember and Ember Data repositories to ember-cli-typescript, as well as converting them to TypeScript and to use the new formats. He also contributed the type definitions for the new (<a href="https://github.com/emberjs/rfcs/pull/232/">RFC #232</a>) QUnit testing API.</p>
<p>Thanks to everyone who contributed to ember-cli-typescript or the Ember typings in any way since we released 1.0.0:</p>
<ul>
<li><p>ember-cli-typescript contributors (note that I intentionally include here everyone who opened issues on the repository: that is <em>not</em> a small thing and has helped us immensely):</p>
<ul>
<li>Bryan Crotaz (<a href="https://github.com/BryanCrotaz">@BryanCrotaz</a>)</li>
<li>Daniel Gratzl (<a href="https://github.com/danielgratzl">@danielgratzl</a>)</li>
<li>Guangda Zhang (<a href="https://github.com/inkless">@inkless</a>)</li>
<li><a href="https://github.com/guangda-prosperworks">@guangda-prosperworks</a></li>
<li>Krati Ahuja (<a href="https://github.com/kratiahuja">@kratiahuja</a>)</li>
<li>Martin Feckie (<a href="https://github.com/mfeckie">@mfeckie</a>)</li>
<li>Nikos Katsikanis (<a href="https://github.com/QuantumInformation">@QuantumInformation</a>)</li>
<li>Per Lundberg (<a href="https://github.com/perlun">@perlun</a>)</li>
<li>Prabhakar Poudel (<a href="https://github.com/prabhakar-poudel">@Prabhakar-Poudel</a>)</li>
<li>Ryan LaBouve (<a href="https://github.com/ryanlabouve">@ryanlabouve</a>)</li>
<li>Simon Ihmig (<a href="https://github.com/simonihmig">@simonihmig</a>)</li>
<li>Theron Cross (<a href="https://github.com/theroncross">@theroncross</a>)</li>
<li>Thomas Gossman (<a href="https://github.com/gossi">@gossi</a>)</li>
<li>Vince Cipriani (<a href="https://github.com/vcipriani">@vcipriani</a>)</li>
</ul></li>
<li><p>Ember typings contributors:</p>
<ul>
<li>Adnan Chowdhury (<a href="https://github.com/bttf">@bttf</a>)</li>
<li>Derek Wickern (<a href="https://github.com/dwickern">@dwickern</a>)</li>
<li>Frank Tan (<a href="https://github.com/tansongyang">@tansongyang</a>)</li>
<li>Guangda Zhang (<a href="https://github.com/inkless">@inkless</a>)</li>
<li>Ignacio Bona Piedrabuena (<a href="https://github.com/igbopie">@igbopie</a>)</li>
<li>Leonard Thieu <a href="https://github.com/leonard-thieu">@leonard-thieu</a></li>
<li>Logan Tegman <a href="https://github.com/ltegman">@ltegman</a></li>
<li>Martin Feckie (<a href="https://github.com/mfeckie">@mfeckie</a>)</li>
<li>Mike North (<a href="https://github.com/maerten">@mike-north</a>)</li>
<li>Nathan Jacobson (<a href="https://github.com/natecj">@natecj</a>)</li>
<li>Per Lundberg (<a href="https://github.com/perlun">@perlun</a>)</li>
<li>Robin Ward (<a href="https://github.com/eviltrout">@eviltrout</a>)</li>
</ul></li>
</ul>
<p>Thanks to Rob Jackson (<a href="https://github.com/rwjblue">@rwjblue</a>) and Tobias Bieniek (<a href="https://github.com/Turbo87">@Turbo87</a> on GitHub, @tbieniek in the Ember Slack) for answering tons of questions and putting up with regular pestering about Ember CLI.</p>
<p>And last but not least, thanks to everyone who’s popped into #topic-typescript on the Ember Community Slack with questions, comments, problem reports, and the occasional word of encouragement. It really does help.</p>
</section>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>For details on how this all works, see <a href="http://www.chriskrycho.com/2018/typing-your-ember-update-part-4.html">TypeScript and Ember.js Update: Part 4</a>, where I discuss these changes in detail.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>although they may actually get some benefits in a number of modern editors, since e.g. VS Code and the JetBrains IDEs will leverage types if they exist!<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>More on that in a post to be released in the next couple weeks—one I promised <em>long</em> ago, but which we’re now in a place to actually do: a plan and a roadmap for typing the whole Ember ecosystem!<a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>And of course, right as we finally landed our support for it, by hacking around the <code>--watch</code> invocation in a lot of really weird ways, Microsoft shipped API-level support for it. We hope to switch to using that under the hood, but that shouldn’t make any difference at all to you as a consumer of the addon, except that if/when we land it at some point, you’ll just have a nicer experience.<a href="#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</section>
        </div>
    </div>
</article>


    <footer id="site-footer"><section id="connect">
    <h2>Connect</h2>
    <ul class="icons">
        <li><a href="https://twitter.com/chriskrycho"><i class="fa fa-fw fa-twitter"></i>Twitter</a></li>
        <li><a href="mailto:chris at chriskrycho dot com"><i class="fa fa-fw fa-envelope"></i>Email</a></li>
        <li><a href="https://github.com/chriskrycho"><i class="fa fa-fw fa-github"></i>GitHub</a></li>
        <li><a href="https://medium.com/@chriskrycho"><i class="fa fa-fw fa-medium"></i>Medium</a></li>
        <li><a href="https://soundcloud.com/chriskrycho"><i class="fa fa-fw fa-soundcloud"></i>SoundCloud</a></li>
        <li><a href="http://instagram.com/chriskrycho"><i class="fa fa-fw fa-instagram"></i>Instagram</a></li>
        <li><a href="http://www.linkedin.com/in/chriskrycho"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a></li>
        <li><a href="https://vimeo.com/chriskrycho"><i class="fa fa-fw fa-vimeo"></i>Vimeo</a></li>
        <li><a href="http://stackoverflow.com/users/564181/chris-krycho"><i class="fa fa-fw fa-stack-overflow"></i>Stack Overflow</a></li>
    </ul>
</section>
<section id="subscribe">
    <h2>Subscribe</h2>
    <ul class="icons">
        <li class="section-title">
            <a onclick="window.open('http://eepurl.com/GzswP', 'subscribe', 'width=608,height=608')">
                   <i class="fa fa-fw fa-envelope"></i>Email
            </a>
        </li>
    </ul>
    <h3>Feeds</h3>
    <ul class="icons">
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feed.xml"><i class="fa fa-fw fa-rss"></i>Everything</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/Art.xml"><i class="fa fa-fw fa-rss"></i>Art</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/blog.xml"><i class="fa fa-fw fa-rss"></i>blog</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/Tech.xml"><i class="fa fa-fw fa-rss"></i>Tech</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/Theology.xml"><i class="fa fa-fw fa-rss"></i>Theology</a>
        </li>
    </ul>
</section>
<section id="recent">
    <h2>Recent</h2>
    <ul>
        <li>Art: <a href="http://www.chriskrycho.com/2018/a-strange-little-thought.html">A Strange Little Thought</a></li>
        <li>Blog: <a href="http://www.chriskrycho.com/2018/writing-plans-for-the-rest-of-2018.html">Writing Plans for the Rest of 2018</a></li>
        <li>Tech: <a href="http://www.chriskrycho.com/2018/emberjs2018-part-2.html">#EmberJS2018, Part 2</a></li>
        <li>Theology: <a href="http://www.chriskrycho.com/2018/handling-the-liberal-order-correctly.html">Handling “The Liberal Order” Correctly</a></li>
    </ul>
</section></footer>

    <script async src="http://code.bib.ly/bibly.min.js"></script>
    <link href="http://code.bib.ly/bibly.min.css" rel="stylesheet" />
    <script type="text/javascript">
    var MTIProjectId='a34d2e31-99b5-469a-9b81-128fc0bd9745';
    </script>

<link rel="stylesheet" href="/assets/tomorrow.min.css">
<script src="/assets/js/highlight.pack.js"></script>
<script type="text/javascript">
// Get all the <pre><code> elements, and use the <pre> element to set the <code>
// element's class so hljs will use it rather than trying to figure it out.
var preEls = document.getElementsByTagName('pre');
for (var e in preEls) {
    var pre = preEls[e];
    if (pre.firstChild && pre.firstChild.tagName === 'CODE') {
        var code = pre.firstChild;
        code.className = pre.className;
    }
}

// Then run hljs.
hljs.initHighlightingOnLoad();
</script>

<script type="text/javascript" src="/assets/js/lib.js"></script>
</body>
</html>