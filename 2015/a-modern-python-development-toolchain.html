<!DOCTYPE html>
<html lang="en">
<head>
    <title>A Modern Python Development Toolchain &middot; Chris Krycho</title>
    <meta name="description" content="Using homebrew, pyenv, and pip to manage Python development environments and workspaces."/>

    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>

<link rel='me' href='https://alpha.app.net/chriskrycho' data-type='follow' data-user-id='@chriskrycho'/>    <meta property="og:url" content="http://www.chriskrycho.com/2015/a-modern-python-development-toolchain.html"/>
    <meta property="og:title" content="A Modern Python Development Toolchain"/>
    <meta property="og:description" content="Using homebrew, pyenv, and pip to manage Python development environments and workspaces."/>
        <meta property="og:image" content="http://www.chriskrycho.com//assets/images/ck.png"/>
<link rel="author" href=""/>
<link rel="me" href=""/><meta name="twitter:card" content="summary"/>
<meta name="twitter:site" content="@chriskrycho"/>
<meta name="twitter:creator" content="@chriskrycho"/>
    <meta name="twitter:title" content="A Modern Python Development Toolchain"/>
    <meta name="twitter:description" content="Using homebrew, pyenv, and pip to manage Python development environments and workspaces."/>
        <meta name="twitter:image" content="http://www.chriskrycho.com/assets/images/ck.png"/>
    <link rel="me" href="http://www.linkedin.com/in/chriskrycho"/>
    <link rel="me" href="https://bitbucket.org/chriskrycho"/>
    <link rel="me" href="https://app.net/chriskrycho"/>
    <link rel="me" href="https://twitter.com/chriskrycho"/>
    <link rel="me" href="https://medium.com/@chriskrycho"/>
    <link rel="me" href="http://stackoverflow.com/users/564181/chris-krycho"/>
    <link rel="me" href="https://www.facebook.com/chriskrycho"/>
    <link rel="me" href="https://github.com/chriskrycho"/>
    <link rel="me" href="https://vimeo.com/chriskrycho"/>
    <link rel="me" href="https://soundcloud.com/chriskrycho"/>
    <link rel="me" href="http://instagram.com/chriskrycho"/>

    <link rel="openid.delegate" href="http://www.chriskrycho.com/" />
    <link rel="openid.server" href="https://indieauth.com/openid" />

    <link rel="stylesheet" type="text/css" href="http://www.chriskrycho.com/assets/style.css"/>
    <link rel="stylesheet" type="text/css" href="http://www.chriskrycho.com/assets/fonts.css"/>
    <link rel="stylesheet" type="text/css" href="http://www.chriskrycho.com/assets/icons.css"/>

    <link href="/favicon.png" type="image/png" rel="icon" />
    <link href="/favicon.ico" type="image/ico" rel="icon" />

    <script type="text/javascript" src="/assets/js/mtiFontTrackingCode.js"></script>

    <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="All posts">
        <link rel="alternate" href="/feeds/art.xml" type="application/rss+xml" title="Posts filed in in 'Art''">
        <link rel="alternate" href="/feeds/blog.xml" type="application/rss+xml" title="Posts filed in in 'Blog''">
        <link rel="alternate" href="/feeds/micro.xml" type="application/rss+xml" title="Posts filed in in 'Micro''">
        <link rel="alternate" href="/feeds/tech.xml" type="application/rss+xml" title="Posts filed in in 'Tech''">
        <link rel="alternate" href="/feeds/Theology.xml" type="application/rss+xml" title="Posts filed in in 'Theology''">
</head>
<body>
    <header id="site-header">
        <div class="hgroup">
            <h1 id="site-title">
<a href="http://www.chriskrycho.com"><img class="logotype" src="/assets/images/ck.png" alt="ck"/>Chris Krycho</a>
</h1>

            <h2 id="site-subtitle">Theology, technology, life & art</h2>
        </div>

        <nav>
            <ul>
                <li class="section-title"><a href="http://www.chriskrycho.com/about.html">About</a></li>
                <li class="section-title art"><a href="http://www.chriskrycho.com/art/">art</a></li>
                <li class="section-title tech"><a href="http://www.chriskrycho.com/tech/">tech</a></li>
                <li class="section-title theology"><a href="http://www.chriskrycho.com/theology/">Theology</a></li>
                <li class="section-title divider" role="presentation"></li>
                <li class="section-title"><a href="http://www.chriskrycho.com/series.html">Series</a></li>
                <li class="section-title divider" role="presentation"></li>
                <li class="section-title"><a href="http://www.chriskrycho.com/archives.html">Archives</a></li>
            </ul>
        </nav>

    </header>


<article class="software-development tech">

    <header>
<h1>A Modern Python Development Toolchain</h1>
    </header>

    <div class="meta"><span class="date"><a href="http://www.chriskrycho.com/2015/a-modern-python-development-toolchain.html"><i class="fa fa-fw fa-link"></i></a>May 16, 2015</span><span class="section">Filed under <a class="section-title" href="http://www.chriskrycho.com/tech/">tech</a></span><span class="hashtag"><a class="hashtags" href="http://www.chriskrycho.com/software-development/">#software development</a></span><span><a href="http://www.chriskrycho.com/2015/a-modern-python-development-toolchain.txt">Markdown source</a></span></div>

    <div class="content-wrapper">


        <div class="content">

<p>Most of my development time these days—and especially the majority of my happiest time!—is spent working in Python. As such, I’ve experimented off and on over the last few years with the best workflow, and have settled down with a set of tools that is <em>very</em> effective and efficient for me. I’m sure I’m not the only one who’s had to wrestle with some of the issues particular to this toolchain, and I know that information like this can be valuable especially for people just starting off, so I thought I would document it all in one place.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<p>Note: when talking about a given program, I will italicize it, like <em>brew</em> or <em>git</em> or <em>python</em>. When talking about things to type, I will make them a code block like <code>git clone &lt;a repository&gt;</code>. For any extended samples, I will make them full-on code blocks:</p>
<pre class="python"><code>import re

def a_neat_function():
    my_string = &quot;Isn&#39;t it cool?&quot;
    if re.match(r&quot;i\w+&quot;, my_string, flags=re.I):
        print(my_string)</code></pre>
<hr />
<p>The main tools I use are: a good text editor (I like all of <a href="//www.sublimetext.com">Sublime Text</a>, <a href="//atom.io">Atom</a>, <a href="//github.com/textmate/textmate">TextMate</a>, and <a href="//chocolatapp.com">Chocolat</a>; each has its own strengths and weaknesses) or sometimes <a href="https://www.jetbrains.com/pycharm/">a full IDE</a>, version control software (I appreciate and use both <a href="http://www.git-scm.com">Git</a> and <a href="http://mercurial.selenic.com">Mercurial</a>), and three dedicated tools to which the rest of this post is devoted: <em>pyenv</em>, <em>pip</em>, and virtual environments.</p>
<p>Everyone is going to have their own preferences for version control tools and an editor; but the recommendations I make regarding Python installations, package management, and workspaces/virtual environments should be fairly standard for anyone doing Python development on a Unix-like system in 2015.</p>
<section id="python-proper" class="level2">
<h2>Python Proper</h2>
<p>First up: Python itself. OS X ships with a built-in copy of Python 2; in the latest version of Yosemite, it’s running Python 2.7.6. The latest version of Python 2 is 2.7.9, so that isn’t <em>terribly</em> far behind—but it is still behind. Moreover, OS X does <em>not</em> ship with Python 3, and since I do all of my development in Python 3<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> I need to install it.</p>
<section id="homebrew" class="level3">
<h3>Homebrew</h3>
<p>For a long time, I managed all my Python installations with <a href="http://brew.sh"><em>homebrew</em></a>. If you’re not familiar with it, <em>homebrew</em> is a package manager that lets you installed tools on the command line, similar to what you get from <em>aptitude</em> or <em>yum</em> on Ubuntu or Fedora respectively.<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> If you’re not using <em>homebrew</em> yet, I highly recommend it for installing command-line tools. (If you’re not using command-line tools yet, then the rest of this post will either bore you to death, or prove extremely enlightening!) If you haven’t started yet, now’s a good time: <a href="http://brew.sh">go install it!</a>.</p>
<p>While <em>homebrew</em> is great for installing and managing packages in general, I can’t say this loud enough: <em>don’t manage Python with homebrew</em>. It’s finicky, and really isn’t meant for all the things you have to do to manage more than one version of Python at a time.<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a> (There’s a reason there’s a whole <a href="https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/Homebrew-and-Python.md">troubleshooting section</a> devoted to it.) If you think it’s crazy that I might want more than one copy of Python installed a time, well… let’s just say I suspect you’ll change your mind after doing a bit more development. (At the most basic, most people will end up wanting both Python 2 and 3 installed, and will want to upgrade them as bug fixes and the like come out.)</p>
</section>
<section id="pyenv" class="level3">
<h3>pyenv</h3>
<p>Instead of installing via <em>homebrew</em>, use it to install <a href="https://github.com/yyuu/pyenv"><em>pyenv</em></a>, and use that to manage your installations. <em>pyenv</em> is a dedicated tool for managing your “Python environment,” and it excels at that. If you were on a Mac with <em>homebrew</em> installed, your setup process to add the latest version of Python might look something like this:</p>
<pre class="shell"><code>$ brew install pyenv
$ echo &#39;eval &quot;$(pyenv init -)&quot;&#39; &gt;&gt; ~.profile
$ source ~/.profile
$ pyenv install 3.4.3</code></pre>
<p>Line by line, that (a) installs <em>pyenv</em>, (b) adds a hook to your shell profile,<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> (c) updates your current session using the updated profile, and (d) installs the latest version of Python (as of the time I’m writing this). Now you have a full version of Python 3.4.3 alongside the system install of Python 2.7.6. If you wanted to install 2.7.9, or 2.2.3, or the development version of PyPy3, you could easily do that as well.</p>
<p>In addition, <em>pyenv</em> lets you specify which version to use globally (<code>pyenv global &lt;name&gt;</code>) and which version to use in a given directory structure (<code>pyenv local &lt;name&gt;</code>). So if you prefer to use Python 3 in general, but need to use Python 2 on one project, you can just navigate to the root of that project and set it:</p>
<pre class="shell"><code>$ pyenv global 3.4.3
$ cd path/to/my/project
$ pyenv local 2.7.9</code></pre>
<p>This will create a simple plain text file, <code>.python-version</code>, whose contents will be just <code>2.7.9</code>—but for everything under <code>path/to/my/project</code>, typing <code>python</code> will launch Python 2.7.9, while typing it <em>outside</em> that folder will launch Python 3.4.3. (If you want, you can just create the <code>.python-version</code> file yourself manually and give it the name of a version. There’s nothing special about it all; it’s just the place <code>pyenv</code> looks to know which Python version to use.)</p>
</section>
</section>
<section id="managing-python-packages" class="level2">
<h2>Managing Python Packages</h2>
<p>There are four basic approaches to managing Python packages:</p>
<ul>
<li>installing them manually</li>
<li>using a system-level package manager like <em>homebrew</em>, <em>yum</em>, or <em>aptitude</em></li>
<li>using <em>easy_install</em></li>
<li>using <em>pip</em></li>
</ul>
<p>The vast majority of the time, the right choice is using <em>pip</em>. Over the last few years, <em>pip</em> has become the default install tool for Python packages and it now ships natively with it on every platform. Suffice it to say: if you need to install a package, do not install it not with <em>homebrew</em> (or <em>aptitude</em> or <em>yum</em>). Install it with <em>pip</em>. It integrates with Python better, it always has access both to the latest versions of Python packages (including those only available in e.g. development repositories on GitHub or Bitbucket or wherever else) and to all previously released versions, and it’s the community’s main tool for the job.</p>
<p>That said, occasionally it makes sense to install packages manually by downloading them and running <code>python setup.py install</code> or to use a system-level package manager. On the other hand, given <em>pip</em>’s ability to do everything <em>easy_install</em> does, and its ability to do quite a few more things as well, there really isn’t a time to use <em>easy_install</em>. Using the language-supplied tools keeps everything playing nicely together. Perhaps just as importantly, it is the only way to make sure everything behaves the way it should when you start using…</p>
</section>
<section id="virtual-environments" class="level2">
<h2>Virtual Environments</h2>
<p>When working with a variety of different clients, or simply on different projects, it is common not only to end up with different versions of Python but also with different sets of packages or—tricker still!—different versions of the same package required for different projects. Virtual environments provide a solution: they reuse the main Python executable (by creating links on the file system to it), but create isolated “workspaces” for the various packages you might install.</p>
<p>That way, in one workspace, you might have version 1.2 of a package installed, and in another you might have version 3.3 installed—because those are the required dependencies for something <em>else</em> you’re doing. This isn’t a hypothetical situation. For quite a while with one of my clients, we had pinned a particular version of the Python documentation package we use because it broke our use case after an update—but I still wanted to have the latest version of that tool in my <em>other</em> projects. Setting up virtual environments neatly solves that problem.</p>
<section id="venv-and-virtualenv" class="level3">
<h3>venv and virtualenv</h3>
<p>If you have Python 3.3 or later, you have a built-in tool for this called <a href="https://docs.python.org/3/library/venv.html"><em>pyvenv</em></a>; if you have Python 3.4 or later, it supports <em>pip</em> right out of the gate so you don’t have to install it yourself. If you’re on older versions, you can install <a href="https://virtualenv.pypa.io/en/latest/"><em>virtualenv</em></a> (<code>pip install virtualenv</code>) and get the same basic tooling: <em>pyvenv</em> was inspired by <em>virtualenv</em>. Then you can create virtual environments with the <code>pyvenv</code> or <code>virtualenv</code> commands, and use those to isolate different setups from each other. If you haven’t started using virtual environments yet, start now!</p>
</section>
<section id="pyenv-with-virtualenv" class="level3">
<h3>pyenv with virtualenv</h3>
<p>I know, the similarity of names for <em>pyenv</em> and <em>pyvenv</em> is unfortunate. If it helps, you can call the latter as <code>venv</code> rather than <code>pyvenv</code>. But, more importantly, one of the areas <em>pyenv</em> is much better than <em>homebrew</em> is its support for managing virtual environments. Install <a href="https://github.com/yyuu/pyenv-virtualenv"><em>pyenv-virtualenv</em></a>:</p>
<pre class="shell"><code>$ brew install pyenv-virtualenv
$ echo &#39;eval &quot;$(pyenv virtualenv-init -)&quot;&#39; &gt;&gt; ~/.profile</code></pre>
<p>Now you’re off to the races: you’ll never have to type <code>pyvenv &lt;path to a virtual environment&gt;</code>, because instead you can just type <code>pyenv virtualenv &lt;version&gt; &lt;name&gt;</code> and <em>pyenv</em> will take care of setting it up for you. Even better: all the nice tricks I listed above about setting directory-specific and global preferences for which Python version to use work equally well with virtual environments managed via <em>pyenv</em>. In other words, you can do something like this:</p>
<pre class="shell"><code>$ pyenv install 2.7.9
$ pyenv install 3.4.3
$ pyenv global 3.4.3
$ pyenv virtualenv 2.7.9 my-virtual-environment
$ cd path/to/my/project
$ pyenv local my-virtual-environment</code></pre>
<p>The <code>.python-version</code> file will contain <code>my-virtual-environment</code>. The Python version will be 2.7.9. The environment will be isolated, just as if you had run <code>pyvenv</code> to set up a virtual environment. Everything works together beautifully! Moreover, you can easily reuse virtual environments this way, because you can set the <code>local</code> value in more than one place. For example, I use the same virtual environment for this site and <a href="//www.winningslowly.org/" title="A podcast: taking the long view on technology, religion, ethics, and art.">Winning Slowly</a>, because they have slightly different site configurations but all the same Python dependencies. Creating it was simple:</p>
<pre class="shell"><code>$ pyenv install 3.4.3
$ pyenv virtualenv 3.4.3 pelican
$ cd ~/Sites/chriskrycho.com
$ pyenv local pelican
$ cd ~/Sites/winningslowly.org
$ pyenv local pelican</code></pre>
<p>I named the virtual environment after <a href="//docs.getpelican.com/">the tool I use to generate the sites</a>, and reused it in both sites. Both now have a <code>.python-version</code> file that reads <code>pelican</code>. Now, anytime I’m working anywhere under <code>~/Sites/chriskrycho.com</code> <em>or</em> <code>~/Sites/winningslowly.org</code>, I have the same tooling in place.</p>
</section>
</section>
<section id="summary" class="level2">
<h2>Summary</h2>
<p>The combination of <em>pip</em>, <em>pyenv</em> and virtual environments makes for a very simple, straightforward process to manage Python environments these days:</p>
<ul>
<li>Install Python versions with <em>pyenv</em>.</li>
<li>Install Python packages with <em>pip</em>.</li>
<li>Set up virtual environments with <em>pyenv-virtualenv</em>.</li>
</ul>
<p>If you stick to those basic rules, Python itself shouldn’t give you any trouble at all.</p>
<div id="refs" class="references">

</div>
</section>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>All the usual caveats apply, of course: this may or may not work well for you; it’s just what works for me, and I make no claim or warranty on the tools below—they’re working well for <em>me</em>, but I don’t maintain them, so if they break, please tell the people who maintain them! Also, because I do nearly all my development on a Mac (I test on Windows, but that’s it), the following is necessarily <em>fairly</em> specific to OS X. You can readily adapt most of it to Linux, though, or even to a <a href="https://www.cygwin.com">Cygwin</a> install on Windows—I do just that when I have cause. But my main tool is a Mac, so that’s what I’ve specialized for.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Lucky me, I know!<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Yes, I know that those are wrappers around Debian and Arch, and I know about <em>apt-get</em> and <em>rpm</em>. No, that information isn’t especially relevant for the rest of this post.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>For example, if you upgrade your Python installation using homebrew and then cleanup the old version (e.g., by running the typical <code>brew update &amp;&amp; brew upgrade &amp;&amp; brew cleanup</code> sequence)—say, from 3.4.2 to 3.4.3—and you have virtual environments which depended on 3.4.2… well, you’re in a bad spot now. A <em>very</em> bad spot. Have fun getting back to a working state!<a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>You can of course drop it directly in <code>.zshrc</code> or <code>.bash_profile</code> or wherever else. <a href="//github.com/chriskrycho/profile">My setup</a> puts all common handling in <code>.profile</code> and runs <code>source .profile</code> as the first action in any other shell configurations.<a href="#fnref5">↩</a></p></li>
</ol>
</section>
        </div>
    </div>
</article>


    <footer id="site-footer"><section id="connect">
    <h2>Connect</h2>
    <ul class="icons">
        <li><a href="https://twitter.com/chriskrycho"><i class="fa fa-fw fa-twitter"></i>Twitter</a></li>
        <li><a href="https://github.com/chriskrycho"><i class="fa fa-fw fa-github"></i>GitHub</a></li>
        <li><a href="https://app.net/chriskrycho"><i class="fa fa-fw fa-adn"></i>App.net</a></li>
        <li><a href="https://soundcloud.com/chriskrycho"><i class="fa fa-fw fa-cloud"></i>SoundCloud</a></li>
        <li><a href="http://instagram.com/chriskrycho"><i class="fa fa-fw fa-instagram"></i>Instagram</a></li>
        <li><a href="http://www.linkedin.com/in/chriskrycho"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a></li>
        <li><a href="https://vimeo.com/chriskrycho"><i class="fa fa-fw fa-vimeo"></i>Vimeo</a></li>
        <li><a href="http://stackoverflow.com/users/564181/chris-krycho"><i class="fa fa-fw fa-stack-overflow"></i>Stack Overflow</a></li>
    </ul>
</section>
<section id="subscribe">
    <h2>Subscribe</h2>
    <ul class="icons">
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feed.xml"><i class="fa fa-fw fa-rss"></i>Everything</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/art.xml"><i class="fa fa-fw fa-rss"></i>art</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/blog.xml"><i class="fa fa-fw fa-rss"></i>blog</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/micro.xml"><i class="fa fa-fw fa-rss"></i>micro</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/tech.xml"><i class="fa fa-fw fa-rss"></i>tech</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/Theology.xml"><i class="fa fa-fw fa-rss"></i>Theology</a>
        </li>
    </ul>
</section>
<section id="recent">
    <h2>Recent</h2>
    <ul>
        <li>Art: <a href="http://www.chriskrycho.com/2016/through-a-paper-veil.html">through a paper veil</a></li>
        <li>Blog: <a href="http://www.chriskrycho.com/2016/trust-fame-and-deceit.html">Trust, Fame, and Deceit</a></li>
        <li>Tech: <a href="http://www.chriskrycho.com/2016/rust-and-swift-xv.html">Rust and Swift (xv)</a></li>
        <li>Theology: <a href="http://www.chriskrycho.com/2016/a-strange-and-messy-deliverance.html">A Strange and Messy Deliverance</a></li>
    </ul>
</section></footer>

    <script async src="http://code.bib.ly/bibly.min.js"></script>
    <link href="http://code.bib.ly/bibly.min.css" rel="stylesheet" />
    <script type="text/javascript">
    var MTIProjectId='a34d2e31-99b5-469a-9b81-128fc0bd9745';
    </script>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/styles/tomorrow.min.css">
<script src="/assets/js/highlight.pack.js"></script>
<script type="text/javascript">
// Get all the <pre><code> elements, and use the <pre> element to set the <code>
// element's class so hljs will use it rather than trying to figure it out.
var preEls = document.getElementsByTagName('pre');
for (var e in preEls) {
    var pre = preEls[e];
    if (pre.firstChild && pre.firstChild.tagName === 'CODE') {
        var code = pre.firstChild;
        code.className = pre.className;
    }
}

// Then run hljs.
hljs.initHighlightingOnLoad();
</script>

<script type="text/javascript" src="/assets/js/spacewell.js"></script>
<script type="text/javascript">
var articles = document.getElementsByTagName('article');
var options = {'emDashes': true, 'enDashes': true};
for (var a in articles) {
  if (articles.hasOwnProperty(a)) { spacewell(articles[a], options); }
}
</script>
</body>
</html>