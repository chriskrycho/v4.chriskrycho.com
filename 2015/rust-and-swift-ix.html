<!DOCTYPE html>
<html lang="en">
<head>
    <title>Rust and Swift (ix) &middot; Chris Krycho</title>
    <meta name="description" content="I am reading through the Swift book, and comparing it to Rust, which I have also been learning over the past few months. As with the other posts in this series, these are off-the-cuff impressions, which may be inaccurate in various ways. I’d be happy to hear feedback! Note …"/>

    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>

<link rel='me' href='https://alpha.app.net/chriskrycho' data-type='follow' data-user-id='@chriskrycho'/>    <meta property="og:url" content="http://v4.chriskrycho.com/2015/rust-and-swift-ix.html"/>
    <meta property="og:title" content="Rust and Swift (ix)"/>
    <meta property="og:description" content="I am reading through the Swift book, and comparing it to Rust, which I have also been learning over the past few months. As with the other posts in this series, these are off-the-cuff impressions, which may be inaccurate in various ways. I’d be happy to hear feedback! Note …"/>
        <meta property="og:image" content="http://v4.chriskrycho.com//assets/images/ck.png"/>
<link rel="author" href=""/>
<link rel="me" href=""/><meta name="twitter:card" content="summary"/>
<meta name="twitter:site" content="@chriskrycho"/>
<meta name="twitter:creator" content="@chriskrycho"/>
    <meta name="twitter:title" content="Rust and Swift (ix)"/>
    <meta name="twitter:description" content="I am reading through the Swift book, and comparing it to Rust, which I have also been learning over the past few months. As with the other posts in this series, these are off-the-cuff impressions, which may be inaccurate in various ways. I’d be happy to hear feedback! Note …"/>
        <meta name="twitter:image" content="http://v4.chriskrycho.com/assets/images/ck.png"/>
    <link rel="me" href="http://stackoverflow.com/users/564181/chris-krycho"/>
    <link rel="me" href="https://github.com/chriskrycho"/>
    <link rel="me" href="https://patreon.com/chriskrycho"/>
    <link rel="me" href="https://soundcloud.com/chriskrycho"/>
    <link rel="me" href="https://vimeo.com/chriskrycho"/>
    <link rel="me" href="https://cash.me/$chriskrycho"/>
    <link rel="me" href="https://twitter.com/chriskrycho"/>
    <link rel="me" href="mailto:chris at chriskrycho dot com"/>
    <link rel="me" href="http://www.linkedin.com/in/chriskrycho"/>

    <link rel="openid.delegate" href="http://v4.chriskrycho.com/" />
    <link rel="openid.server" href="https://indieauth.com/openid" />

    <link rel="stylesheet" type="text/css" href="/assets/fonts.css"/>
    <link rel="stylesheet" type="text/css" href="/assets/style.css"/>
    <link rel="stylesheet" type="text/css" href="/assets/archival.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel='stylesheet' href='//cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css'>

    <link href="/favicon.png" type="image/png" rel="icon" />
    <link href="/favicon.ico" type="image/ico" rel="icon" />

    <script type="text/javascript" src="/assets/js/mtiFontTrackingCode.js"></script>


    <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="All posts">
        <link rel="alternate" href="/feeds/Art.xml" type="application/rss+xml" title="Posts filed in in 'Art''">
        <link rel="alternate" href="/feeds/Blog.xml" type="application/rss+xml" title="Posts filed in in 'Blog''">
        <link rel="alternate" href="/feeds/Tech.xml" type="application/rss+xml" title="Posts filed in in 'Tech''">
        <link rel="alternate" href="/feeds/Theology.xml" type="application/rss+xml" title="Posts filed in in 'Theology''">
</head>
<body>
    <div id="archival-notice">This version of the site is now archived. See the next version at <a href="https://v5.chriskrycho.com">v5.chriskrycho.com</a>.</div>
    <header id="site-header">
        <div class="hgroup">
            <h1 id="site-title">
<a href="http://v4.chriskrycho.com"><img class="logotype" src="/assets/images/ck.png" alt="ck"/>Chris Krycho</a>
</h1>

            <h2 id="site-subtitle">Theology, technology, life & art</h2>
        </div>

        <nav>
            <ul>
                <li class="section-title"><a href="http://v4.chriskrycho.com/art/">Art</a></li>
                <li class="section-title"><a href="http://v4.chriskrycho.com/tech/">Tech</a></li>
                <li class="section-title"><a href="http://v4.chriskrycho.com/theology/">Theology</a></li>
                <li class="section-title divider" role="presentation"></li>
                <li class="section-title"><a href="http://v4.chriskrycho.com/series.html">Series</a></li>
                <li class="section-title divider" role="presentation"></li>
                <li class="section-title"><a href="http://v4.chriskrycho.com/about">About</a></li>
                <li class="section-title"><a href="http://v4.chriskrycho.com/cv">C.V.</a></li>
                <li class="section-title"><a href="http://v4.chriskrycho.com/now">Now</a></li>
            </ul>
        </nav>

    </header>


<article class="software-development listicles rust swift rust-and-swift tech">

    <header>
<h1>Rust and Swift (ix)</h1>
<h2>Sum types (<code>enum</code>s) and more on pattern matching
</h2>    </header>

    <div class="meta">
<span class="date"><a href="http://v4.chriskrycho.com/2015/rust-and-swift-ix.html" title="Rust and Swift (ix)"><i class="fa fa-fw fa-link"></i></a>November 09, 2015 (updated June 22, 2019)</span><span class="section">Filed under <a class="section-title" href="http://v4.chriskrycho.com/tech/">Tech</a></span><span class="hashtag"><a class="hashtags" href="http://v4.chriskrycho.com/listicles/">#listicles</a><a class="hashtags" href="http://v4.chriskrycho.com/rust/">#rust</a><a class="hashtags" href="http://v4.chriskrycho.com/rust-and-swift/">#rust-and-swift</a><a class="hashtags" href="http://v4.chriskrycho.com/software-development/">#software development</a><a class="hashtags" href="http://v4.chriskrycho.com/swift/">#swift</a></span><span><a href="http://v4.chriskrycho.com/2015/rust-and-swift-ix.txt">Markdown source</a></span>    </div>

    <div class="content-wrapper">


        <div class="content">

<p><i class="editorial">I am reading through the Swift book, and comparing it to Rust, which I have also been learning over the past few months. As with the other posts in this series, these are off-the-cuff impressions, which may be inaccurate in various ways. I’d be happy to hear feedback! Note, too, that my preferences are just that: preferences. Your tastes may differ from mine. <a href="/rust-and-swift.html">(See all parts in the series.)</a></i></p>
<hr />
<ul>
<li><p>Right off the bat when looking at the definitions for Swift’s and Rust’s <code>enum</code> types, a difference pops out: the use of the keyword <code>case</code> to introduce an enum member in Swift. In one sense, this overloads that keyword, but in another sense it’s fine: pattern matching and enums go hand in hand, so the use in both cases is fairly natural. Rust doesn’t have any special syntax to designate the elements of an enum; they’re just separated by commas.</p></li>
<li><p>I am not at all shocked to find that Swift has a variant syntax for its unit type case declarations, where a single <code>case</code> keyword precedes a list of comma-separated cases defined on a single line. (At this point, I would be more surprised <em>not</em> to find a variant syntax for something in Swift!)</p></li>
<li><p>Something truly wonderful about both Rust and Swift: enumerated types aren’t just wrappers around integer values. They’re real types of their own. This is powerful.</p></li>
<li><p>Rust and Swift also share in having enumerated types that can hold values. The most prominent of these so far in the Swift book are optionals, the <code>Optional</code> enum type, corresponding very closely to Rust’s <code>Option</code> type. Having had these for a bit in playing with Rust, and having gotten familiar with the utility of types like these while reading <a href="https://gumroad.com/l/maybe-haskell"><em>Maybe Haskell</em></a>—a delightful book which introduces Haskell and functional programming using Haskell’s <code>Maybe</code> type—I now miss them profoundly in languages which don’t have them. (Which is to say: every language I use on a regular basis professionally: C, C++, Python, JavaScript, etc.).</p></li>
<li><p>Swift’s enum types don’t have integer values <em>by default</em>—but they can have them if you define a type and assign a value to each enum case at the definition. These “raw values” are distinct from the “associated values” noted just above. I expect these exist primarily for ease of interoperation with Objective-C.</p></li>
<li><p><del>Rust doesn’t have anything like this, at least that I can think of. The main place it would be useful would be for foreign function interfaces (as in Swift), and this is one of several such gaps in Rust,</del> along with the lack of a straightforward way to map to C’s <code>union</code> types. <del>There are trade offs in terms of adding the functionality to the language, though, as it substantially increases the complexity of what an enum value can be, I think.</del></p>
<p><strong>Edit:</strong> This was incorrect. From the <a href="https://doc.rust-lang.org/reference.html">Rust Reference</a> section on <a href="https://doc.rust-lang.org/reference.html#enumerations">Enumerations</a>:</p>
<blockquote>
<p>Enums have a discriminant. You can assign them explicitly:</p>
<pre class="rust"><code>enum Foo {
    Bar = 123,
}</code></pre>
<p>If a discriminant isn’t assigned, they start at zero, and add one for each variant, in order.</p>
<p>You can cast an enum to get this value:</p>
<pre class="rust"><code>let x = Foo::Bar as u32; // x is now 123u32</code></pre>
<p>This only works as long as none of the variants have data attached. If it were <code>Bar(i32)</code>, this is disallowed.</p>
</blockquote></li>
<li><p>Initialization of Swift’s raw-valued enum type is quite similar, and pleasantly so, to Python’s initialization of enums.</p></li>
<li><p>In a surprising change from the usual, Swift’s syntax for binding variable names when pattern matching against an enum is <em>more</em> verbose than Rust’s, requiring the use of either a leading <code>let</code> on the <code>case</code> statement if all the elements are of the same type, or a <code>let</code> in front of each element otherwise:</p>
<pre class="swift"><code>var matchedValue: String
let matchee = 3.14159
switch matchee {
case 3.14159:
    matchedValue = &quot;pi&quot;
case _:
    matchedValue = &quot;not pi&quot;
}</code></pre>
<p>In Rust, a matched pattern can simply bind its value directly:</p>
<pre class="rust"><code>let matchee = 3.14159;
let matchedValue = match matchee {
    3.14159 =&gt; &quot;pi&quot;.to_string(),
    _ =&gt; &quot;not pi&quot;.to_string()
};</code></pre></li>
<li><p>Swift has the ability to do recursive enumerations with its <code>indirect</code> type. This is conceptually interesting, but off the top of my head I can’t think of a time when this would have been useful at any point since I started programming seven and a half years ago. The book’s example of a recursive function aliasing arithmetic expressions is fine, but not particularly illuminating to me. I suspect, though, that it might make more sense if I were more familiar with pure functional programming paradigms.</p>
<p><strong>Edit:</strong> a friend <a href="https://alpha.app.net/jws/post/65990633">points out</a>:</p>
<blockquote>
<p>Indirect enums are useful for recursive types in general. There are a lot of these: Lists, trees, and streams are the big ones that come to mind.</p>
</blockquote></li>
<li><p>All those same lines: Rust does <em>not</em> have the ability to have recursive enumerations at present (or recursive <code>struct</code> types, for that matter), at least without heap-allocating with <code>Box</code> along the way. You <em>can</em> construct such a type, in other words, but you have to be explicit about how you’re handling the memory, and it can’t be stack-allocated.</p>
<ul>
<li><p>For an example of a recursive enumeration type (as well as an interesting/hilarious example of how you can easily confuse the compiler if you do this wrong), see <a href="https://users.rust-lang.org/t/recursive-enum-types/2938">this Rust forum post</a>.</p></li>
<li><p>For some discussion on stack- and heap-allocated memory in Rust, I’ll shamelessly promote my Rust podcast, <a href="http://www.newrustacean.com">New Rustacean</a>: take a listen to <a href="http://www.newrustacean.com/show_notes/e005/index.html">e005: Allocate it where?</a></p></li>
</ul></li>
</ul>
<hr />
<ul>
<li><a href="http://v4.chriskrycho.com/2015/rust-and-swift-viii.html"><strong>Previous:</strong> Functions, closures, and an awful lot of Swift syntax.</a></li>
<li><a href="http://v4.chriskrycho.com/2015/rust-and-swift-x.html"><strong>Next:</strong> Classes and structs (product types), and reference and value types.</a></li>
</ul>
        </div>
    </div>
</article>


    <footer id="site-footer"><section id="connect">
    <h2>Connect</h2>
    <ul class="icons">
        <li><a href="mailto:chris at chriskrycho dot com"><i class="fa fa-fw fa-envelope"></i>Email</a></li>
        <li><a href="https://github.com/chriskrycho"><i class="fa fa-fw fa-github"></i>GitHub</a></li>
        <li><a href="https://twitter.com/chriskrycho"><i class="fa fa-fw fa-twitter"></i>Twitter</a></li>
        <li><a href="https://soundcloud.com/chriskrycho"><i class="fa fa-fw fa-soundcloud"></i>SoundCloud</a></li>
        <li><a href="http://www.linkedin.com/in/chriskrycho"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a></li>
        <li><a href="https://vimeo.com/chriskrycho"><i class="fa fa-fw fa-vimeo"></i>Vimeo</a></li>
        <li><a href="http://stackoverflow.com/users/564181/chris-krycho"><i class="fa fa-fw fa-stack-overflow"></i>Stack Overflow</a></li>
    </ul>
    <h3>Support Me</h3>
    <ul class='icons'>
        <li><a href="https://patreon.com/chriskrycho"><i class='fa fa-fw fa-money'></i>Patreon</a></li>
        <li><a href="https://cash.me/$chriskrycho"><i class='fa fa-fw fa-usd'></i>Cash.me</a></li>
    </ul>
</section>
<section id="subscribe">
    <h2>Subscribe</h2>
    <ul class="icons">
        <li class="section-title">
            <a onclick="window.open('http://eepurl.com/GzswP', 'subscribe', 'width=608,height=608')">
                   <i class="fa fa-fw fa-envelope"></i>Email
            </a>
        </li>
    </ul>
    <h3>Feeds</h3>
    <ul class="icons">
        <li class="section-title">
            <a href="http://v4.chriskrycho.com/feed.xml"><i class="fa fa-fw fa-rss"></i>Everything</a>
        </li>
        <li class="section-title">
            <a href="http://v4.chriskrycho.com/feeds/Art.xml"><i class="fa fa-fw fa-rss"></i>Art</a>
        </li>
        <li class="section-title">
            <a href="http://v4.chriskrycho.com/feeds/Blog.xml"><i class="fa fa-fw fa-rss"></i>Blog</a>
        </li>
        <li class="section-title">
            <a href="http://v4.chriskrycho.com/feeds/Tech.xml"><i class="fa fa-fw fa-rss"></i>Tech</a>
        </li>
        <li class="section-title">
            <a href="http://v4.chriskrycho.com/feeds/Theology.xml"><i class="fa fa-fw fa-rss"></i>Theology</a>
        </li>
    </ul>
</section>
<section id="recent">
    <h2>Recent</h2>
    <ul>
        <li>Art: <a href="http://v4.chriskrycho.com/2019/photography-ing-again.html">Photography-ing Again!</a></li>
        <li>Blog: <a href="http://v4.chriskrycho.com/2019/sympolymathesy-or-v5chriskrychocom.html">Sympolymathesy, or: v5.chriskrycho.com
</a></li>
        <li>Tech: <a href="http://v4.chriskrycho.com/2019/test-the-interface.html">Test the Interface</a></li>
        <li>Theology: <a href="http://v4.chriskrycho.com/2019/review-what-is-an-evangelical.html">Review: <cite>What is an Evangelical</cite>
</a></li>
    </ul>
</section></footer>

    <script type="text/javascript">
    var MTIProjectId='a34d2e31-99b5-469a-9b81-128fc0bd9745';
    </script>

<link rel="stylesheet" href="/assets/tomorrow.min.css">
<script src="/assets/js/highlight.pack.js"></script>
<script type="text/javascript">
// Get all the <pre><code> elements, and use the <pre> element to set the <code>
// element's class so hljs will use it rather than trying to figure it out.
var preEls = document.getElementsByTagName('pre');
for (var e in preEls) {
    var pre = preEls[e];
    if (pre.firstChild && pre.firstChild.tagName === 'CODE') {
        var code = pre.firstChild;
        code.className = pre.className;
    }
}

// Then run hljs.
hljs.initHighlightingOnLoad();
</script>

<script type="text/javascript" src="/assets/js/lib.js"></script>
</body>
</html>