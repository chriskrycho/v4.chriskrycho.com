<!DOCTYPE html>
<html lang="en">
<head>
    <title>CSS Fallback for OpenType Small Caps &middot; Chris Krycho</title>
    <meta name="description" content="I wrote this up as a question on Stack Overflow a bit over a year ago. It has continued to get a fair bit of traffic, so I’ve republished it here and cleaned it up a bit. The Problem Over the last year, I’ve worked on a site ..."/>

    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>

<link rel='me' href='https://alpha.app.net/chriskrycho' data-type='follow' data-user-id='@chriskrycho'/>    <meta property="og:url" content="http://www.chriskrycho.com/2015/css-fallback-for-opentype-small-caps.html"/>
    <meta property="og:title" content="CSS Fallback for OpenType Small Caps"/>
    <meta property="og:description" content="I wrote this up as a question on Stack Overflow a bit over a year ago. It has continued to get a fair bit of traffic, so I’ve republished it here and cleaned it up a bit. The Problem Over the last year, I’ve worked on a site ..."/>
        <meta property="og:image" content="http://www.chriskrycho.com//assets/images/ck.png"/>
<link rel="author" href=""/>
<link rel="me" href=""/><meta name="twitter:card" content="summary"/>
<meta name="twitter:site" content="@chriskrycho"/>
<meta name="twitter:creator" content="@chriskrycho"/>
    <meta name="twitter:title" content="CSS Fallback for OpenType Small Caps"/>
    <meta name="twitter:description" content="I wrote this up as a question on Stack Overflow a bit over a year ago. It has continued to get a fair bit of traffic, so I’ve republished it here and cleaned it up a bit. The Problem Over the last year, I’ve worked on a site ..."/>
        <meta name="twitter:image" content="http://www.chriskrycho.com/assets/images/ck.png"/>
    <link rel="me" href="http://instagram.com/chriskrycho"/>
    <link rel="me" href="https://medium.com/@chriskrycho"/>
    <link rel="me" href="https://vimeo.com/chriskrycho"/>
    <link rel="me" href="https://www.facebook.com/chriskrycho"/>
    <link rel="me" href="https://github.com/chriskrycho"/>
    <link rel="me" href="https://bitbucket.org/chriskrycho"/>
    <link rel="me" href="https://soundcloud.com/chriskrycho"/>
    <link rel="me" href="http://www.linkedin.com/in/chriskrycho"/>
    <link rel="me" href="http://stackoverflow.com/users/564181/chris-krycho"/>
    <link rel="me" href="https://app.net/chriskrycho"/>
    <link rel="me" href="https://twitter.com/chriskrycho"/>

    <link rel="openid.delegate" href="http://www.chriskrycho.com/" />
    <link rel="openid.server" href="https://indieauth.com/openid" />

    <link rel="stylesheet" type="text/css" href="http://www.chriskrycho.com/assets/style.css"/>
    <link rel="stylesheet" type="text/css" href="http://www.chriskrycho.com/assets/fonts.css"/>
    <link rel="stylesheet" type="text/css" href="http://www.chriskrycho.com/assets/icons.css"/>

    <link href="/favicon.png" type="image/png" rel="icon" />
    <link href="/favicon.ico" type="image/ico" rel="icon" />

    <script type="text/javascript" src="/assets/js/mtiFontTrackingCode.js"></script>

    <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="All posts">
        <link rel="alternate" href="/feeds/art.xml" type="application/rss+xml" title="Posts filed in in 'Art''">
        <link rel="alternate" href="/feeds/blog.xml" type="application/rss+xml" title="Posts filed in in 'Blog''">
        <link rel="alternate" href="/feeds/micro.xml" type="application/rss+xml" title="Posts filed in in 'Micro''">
        <link rel="alternate" href="/feeds/talks.xml" type="application/rss+xml" title="Posts filed in in 'Talks''">
        <link rel="alternate" href="/feeds/tech.xml" type="application/rss+xml" title="Posts filed in in 'Tech''">
        <link rel="alternate" href="/feeds/Theology.xml" type="application/rss+xml" title="Posts filed in in 'Theology''">
</head>
<body>
    <header id="site-header">
        <div class="hgroup">
            <h1 id="site-title">
<a href="http://www.chriskrycho.com"><img class="logotype" src="/assets/images/ck.png" alt="ck"/>Chris Krycho</a>
</h1>

            <h2 id="site-subtitle">Theology, technology, life & art</h2>
        </div>

        <nav>
            <ul>
                <li class="section-title"><a href="http://www.chriskrycho.com/about.html">About</a></li>
                <li class="section-title art"><a href="http://www.chriskrycho.com/art/">art</a></li>
                <li class="section-title blog"><a href="http://www.chriskrycho.com/blog/">blog</a></li>
                <li class="section-title talks"><a href="http://www.chriskrycho.com/talks/">talks</a></li>
                <li class="section-title tech"><a href="http://www.chriskrycho.com/tech/">tech</a></li>
                <li class="section-title theology"><a href="http://www.chriskrycho.com/theology/">Theology</a></li>
            </ul>
        </nav>

    </header>


<article class="design software-development typography tech">

    <header>
<h1>CSS Fallback for OpenType Small Caps</h1>
<h2>A not-so-great solution which still gets the job done.</h2>    </header>

    <div class="meta"><span class="date"><a href="http://www.chriskrycho.com/2015/css-fallback-for-opentype-small-caps.html"><i class="fa fa-fw fa-link"></i></a>October 19, 2015</span><span class="section">Filed under <a class="section-title" href="http://www.chriskrycho.com/tech/">tech</a></span><span class="hashtag"><a class="hashtags" href="http://www.chriskrycho.com/design/">#design</a><a class="hashtags" href="http://www.chriskrycho.com/software-development/">#software development</a><a class="hashtags" href="http://www.chriskrycho.com/typography/">#typography</a></span><span><a href="http://www.chriskrycho.com/2015/css-fallback-for-opentype-small-caps.txt">Markdown source</a></span></div>

    <div class="content-wrapper">


        <div class="content">

<p><i class=editorial>I wrote this up as <a href="http://stackoverflow.com/questions/24846264/css-fallback-for-opentype-small-caps/25172932#25172932">a question on Stack Overflow</a> a bit over a year ago. It has continued to get a fair bit of traffic, so I’ve republished it here and cleaned it up a bit.</i></p>
<section id="the-problem" class="level2">
<h2>The Problem</h2>
<p>Over the last year, I’ve worked on <a href="//holybible.com">a site</a> where small caps are important: setting the text of the Bible. In the Old Testament the name of God is transliterated as <code>Lord</code> but in small caps—not “LORD” but <span class="divine-name">Lord</span> (RSS readers will want to click through and see this on my site). However, the state of OpenType small caps support at the moment is… less than optimal. Safari (even up through Safari 9 on El Capitan, from which I am typing this) still doesn’t support the <code>-webkit-font-feature-settings: 'smcp'</code> option, and a lot of the hits for this website will be coming from mobile.</p>
<p>Unfortunately, “graceful degradation” is problematic here: if you specify both <code>font-variant: small-caps</code> and <code>font-feature-settings: 'smcp'</code> in a browser that supports the latter (e.g. Chrome), the <code>font-variant</code> declaration overrides it, so the horribly ugly old-style version still comes into play. (Note: this is as it should be per the <a href="http://www.w3.org/TR/css-fonts-3/#feature-precedence">spec</a>: the <code>font-variant</code> declaration has a higher priority than the <code>font-feature-settings</code> declaration). Given the current implementations of <code>font-variant: small-caps</code>, though—shrunken capitals rather than actual small capitals—the result is that using <code>font-variant: small-caps</code> realists in not-so-gracefully degrading <em>everyone’s</em> reading experience.</p>
<p>In the past, I have exported the small caps as a distinct webfont and specified them directly; see <a href="http://www.chriskrycho.com/2014/learning-qml-part-1.html">this post</a> for a simple example: the first line of each paragraph is specified that way.</p>
<p>While I <em>can</em> do the same thing here (and at least in theory could deliver a pretty small typeface, since I really only need three characters: <code>o</code>, <code>r</code>, and <code>d</code>), I’d prefer simply to enable sane fallbacks. As noted above, however, that’s not possible. I am <em>open to</em> but would very much prefer to avoid server-side solutions (browser detection, etc.) as a point of complexity that is better to minimize, especially given how rapidly browsers change. How else might one solve this problem, and especially are there existing solutions for it?</p>
<p>In the future, <code>font-variant: small-caps</code> will handle this nicely, as per <a href="http://www.w3.org/TR/css3-fonts/#small-caps">the spec</a> it should display a small-capitals-variant of the typeface if the typeface supplies it. However, at present, <em>no browser supports this</em> (at least, none that I can find!). This means that instead, they all render fake small capitals simply by scaling down actual capitals. The result is typographically unpleasant, and unacceptable on this project.</p>
</section>
<section id="the-solutions" class="level2">
<h2>The Solution(s)</h2>
<p>I spent a considerable amount of time researching this and wrestling with it. After digging around as best I could, the top solutions for now are:</p>
<section id="supports" class="level3">
<h3><code>@supports</code></h3>
<p>Take advantage of the <code>@supports</code> rule in browsers. This is what I initially opted to do on this project.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> You use the rule this way:</p>
<pre class="css"><code>.some-class {
    font-variant: small-caps;
}

@supports(font-feature-settings: &#39;smcp&#39;) {
    .some-class {
        font-variant: normal;
        font-feature-settings: &#39;smcp&#39;;
    }
}</code></pre>
<p>(I’ve simplified by leaving out the prefixed versions; you’ll need to add the <code>-webkit-</code> and <code>-moz-</code> prefixes to get this actually working.) This has the advantage that support for real small caps and support for the <code>@supports</code> rule are very similar:</p>
<ul>
<li><code>@supports</code>: <a href="http://caniuse.com/#feat=css-featurequeries">Can I Use Feature Queries?</a>: Chrome 31+, Firefox 29+, Opera 23+, Android 4.4+, Safari 9+, Edge 12+, Chrome for Android</li>
<li><code>font-feature-settings</code>: <a href="http://usabilitypost.com/2014/05/10/using-small-caps-and-text-figures-on-the-web/">Using Small Caps &amp; Text Figures on the Web</a>: Chrome, Firefox, IE10+</li>
</ul>
<p>This isn’t perfect: since IE10/11 don’t implement <code>@supports</code>, you miss one browser—sort of. At this point, IE is a legacy browser, and Edge has had <code>@supports</code> available from the start. Thus, this gets you most of the way there, and it should be future-facing: this should progressively enhance the site nicely. The normal (bad, but functional) small caps are displayed in the meantime, and when browsers eventually get around to using OpenType small caps by default for <code>font-variant: small-caps</code>, this will continue to work just fine. It’s “progressive enhancement” and it’ll work nicely for most purposes.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
</section>
<section id="typeface-subsetting" class="level3">
<h3>Typeface subsetting</h3>
<p>As mentioned above, one can create a subset of the typeface that includes only small capitals. This is what I have done for the small caps on this site; see the example in the first paragraph.</p>
<p>To pull this off, you’ll need to start by subsetting the typeface. You can do this manually with a font tool, or (the simpler way) you can use FontSquirrel’s custom subsetting tool in their <a href="http://www.fontsquirrel.com/tools/webfont-generator">webfont generator</a>. (<strong><em>Note:</em></strong> You <em>must</em> check the license and confirm that the typeface in question allows this kind of modification. See below.) In the web font generator, first upload the file you wish to modify. Then choose the <strong>Expert</strong> radio button. Most of the settings you can leave as they are; they’re good sane defaults. Midway down the page you’ll see <strong>OpenType Flattening</strong> options. Here, select only “Small Caps”. Run the generator. The result will be a complete replacement of the normal lowercase letters with the small caps set.<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a></p>
<p>In that case, you can simply apply a style to the elements you want to have small capitals, e.g.:</p>
<pre class="css"><code>.divine-name {
    font-family: &#39;my_typeface_smcp&#39;, &#39;my_typeface&#39;, serif;
}</code></pre>
<p>The major advantage to this approach is consistency: that typeface is going to display on every browser out there, back to IE5.5, as long as you deliver it correctly using the various hooks required by <code>@font-face</code>.</p>
<p>There are a few disadvantages to this approach, though:</p>
<ol type="1">
<li><p>It means delivering another font file. In my case, this would be an acceeptably low size (since I actually only need four characters), but it’s still something to consider in general. It is in any case another HTTP request, which is going to further slow the page load time or at least give you some flash of unstyled text when it reloads.</p></li>
<li><p>It may violate the licenses of the typefaces in question. For at least one of the fonts I used on this project, it <em>does</em>: the license explicitly forbids rebuilding the font using tools like FontSquirrel. (FontSquirrel was the tool I used for this approach before, and it works quite well.) This is a make-or-break issue for using a subset of a typeface to accomplish the goal. That being said, if you have a good reason to do it, you may be able to get support from the vendor (especially if they’re a small shop). For the project that prompted this question, I was able to do just that with a nice email—the designer is a great guy.</p></li>
</ol>
<p>The other major reason not to do it this way is that it has a significantly higher maintenance cost. If at any point you need to change or update the typeface, you have to go through the subsetting process all over again. By contrast, the first option will simply <em>work</em>, though admittedly not as pleasantly as one might hope, and will not only continue to work but will actually improve over time as browsers increase their implementation of the CSS3 standard.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2>Conclusion</h2>
<p>I opted for the second solution on HolyBible.com—typography was one of the driving differentiators for the site, so I prioritized it and did the necessary legwork for it. In general, though, the first option should work well for most sites. In any case, both ways work, though the first one is a <em>better</em> example of progressive enhancement. And we can all look forward to the day when true small-caps support is available on every browser, right?</p>
<div id="refs" class="references">

</div>
</section>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>For various reasons (especially see note 2 below), I actually opted for the second approach outlined here, which is the same approach I was trying to avoid. Alas.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Issues remain: even in the latest Chrome (46 as of the time of this post), using the <code>font-feature-settings: 'smcp'</code> approach has some issues. For example, if you turn on <code>letter-spacing</code> (a fairly common <a href="http://practicaltypography.com/letterspacing.html">recommendation</a> for small caps), the small caps will revert to normal lowercase letters.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>From the FontSquirrel blog post that introduced the feature:</p>
<blockquote>
<p>If you have a font with OpenType features, you can now flatten some of them into your webfont. For instance, some fonts have small caps built in, but they are completely inaccessible in a web browser. By selecting the “Small Cap” option, the Generator will replace all the lowercase glyphs with the small cap variants, giving you a small cap font. Please note that not all OpenType features are supported and if the font lacks OpenType features, using these options won’t create them.</p>
</blockquote>
<a href="#fnref3">↩</a></li>
</ol>
</section>
        </div>
    </div>
</article>


    <footer id="site-footer"><section id="connect">
    <h2>Connect</h2>
    <ul class="icons">
        <li><a href="https://twitter.com/chriskrycho"><i class="fa fa-fw fa-twitter"></i>Twitter</a></li>
        <li><a href="https://github.com/chriskrycho"><i class="fa fa-fw fa-github"></i>GitHub</a></li>
        <li><a href="https://app.net/chriskrycho"><i class="fa fa-fw fa-adn"></i>App.net</a></li>
        <li><a href="https://soundcloud.com/chriskrycho"><i class="fa fa-fw fa-cloud"></i>SoundCloud</a></li>
        <li><a href="http://instagram.com/chriskrycho"><i class="fa fa-fw fa-instagram"></i>Instagram</a></li>
        <li><a href="http://www.linkedin.com/in/chriskrycho"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a></li>
        <li><a href="https://vimeo.com/chriskrycho"><i class="fa fa-fw fa-vimeo"></i>Vimeo</a></li>
        <li><a href="http://stackoverflow.com/users/564181/chris-krycho"><i class="fa fa-fw fa-stack-overflow"></i>Stack Overflow</a></li>
    </ul>
</section>
<section id="subscribe">
    <h2>Subscribe</h2>
    <ul class="icons">
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feed.xml"><i class="fa fa-fw fa-rss"></i>Everything</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/art.xml"><i class="fa fa-fw fa-rss"></i>art</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/blog.xml"><i class="fa fa-fw fa-rss"></i>blog</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/micro.xml"><i class="fa fa-fw fa-rss"></i>micro</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/talks.xml"><i class="fa fa-fw fa-rss"></i>talks</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/tech.xml"><i class="fa fa-fw fa-rss"></i>tech</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/Theology.xml"><i class="fa fa-fw fa-rss"></i>Theology</a>
        </li>
    </ul>
</section>
<section id="recent">
    <h2>Recent</h2>
    <ul>
        <li>Art: <a href="http://www.chriskrycho.com/2016/time.html">Time</a></li>
        <li>Blog: <a href="http://www.chriskrycho.com/2016/trust-fame-and-deceit.html">Trust, Fame, and Deceit</a></li>
        <li>Talks: <a href="http://www.chriskrycho.com/2015/tolle-lege.html">Tolle Lege!</a></li>
        <li>Tech: <a href="http://www.chriskrycho.com/2016/i-dont-know-when-id-use-that.html">“I Don't Know When I'd Use That”</a></li>
        <li>Theology: <a href="http://www.chriskrycho.com/2016/a-humble-selfless-unity.html">A Humble, Selfless, Unity</a></li>
    </ul>
</section></footer>

    <script async src="http://code.bib.ly/bibly.min.js"></script>
    <link href="http://code.bib.ly/bibly.min.css" rel="stylesheet" />
    <script type="text/javascript">
    var MTIProjectId='a34d2e31-99b5-469a-9b81-128fc0bd9745';
    </script>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/styles/tomorrow.min.css">
<script src="/assets/js/highlight.pack.js"></script>
<script type="text/javascript">
// Get all the <pre><code> elements, and use the <pre> element to set the <code>
// element's class so hljs will use it rather than trying to figure it out.
var preEls = document.getElementsByTagName('pre');
for (var e in preEls) {
    var pre = preEls[e];
    if (pre.firstChild && pre.firstChild.tagName === 'CODE') {
        var code = pre.firstChild;
        code.className = pre.className;
    }
}

// Then run hljs.
hljs.initHighlightingOnLoad();
</script>

<script type="text/javascript" src="/assets/js/spacewell.js"></script>
<script type="text/javascript">
var articles = document.getElementsByTagName('article');
var options = {'emDashes': true, 'enDashes': true};
for (var a in articles) {
  if (articles.hasOwnProperty(a)) { spacewell(articles[a], options); }
}
</script>
</body>
</html>